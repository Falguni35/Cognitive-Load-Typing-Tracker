<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mental Health Assistant</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --bg-primary: #0f172a;
        --bg-secondary: #1e293b;
        --bg-tertiary: #334155;
        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --accent: #3b82f6;
        --accent-hover: #2563eb;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --border: #475569;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      header {
        background: var(--bg-secondary);
        padding: 24px;
        border-radius: 12px;
        margin-bottom: 24px;
        border: 1px solid var(--border);
        position: relative;
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .header-text h1 {
        font-size: 28px;
        margin-bottom: 8px;
        color: var(--accent);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .header-text p {
        color: var(--text-secondary);
        margin-bottom: 12px;
      }

      .back-button {
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        color: var(--text-primary);
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
      }

      .back-button:hover {
        background: var(--accent);
        color: white;
        transform: translateY(-1px);
      }

      .chat-container {
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 12px;
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .chat-box {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .chat-box::-webkit-scrollbar {
        width: 8px;
      }

      .chat-box::-webkit-scrollbar-track {
        background: var(--bg-tertiary);
        border-radius: 4px;
      }

      .chat-box::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 4px;
      }

      .message {
        display: flex;
        gap: 12px;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .message-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        flex-shrink: 0;
      }

      .bot-avatar {
        background: linear-gradient(135deg, var(--accent), #8b5cf6);
      }

      .user-avatar {
        background: linear-gradient(135deg, var(--success), #10b981);
      }

      .message-content {
        flex: 1;
      }

      .message-text {
        background: var(--bg-tertiary);
        padding: 12px 16px;
        border-radius: 12px;
        border: 1px solid var(--border);
        margin-bottom: 8px;
      }

      .user-message .message-text {
        background: var(--accent);
        border-color: var(--accent);
      }

      .message-sender {
        font-weight: 600;
        margin-bottom: 4px;
        font-size: 14px;
        color: var(--text-secondary);
      }

      .options-container {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 8px;
      }

      .option-button {
        padding: 8px 16px;
        border: 2px solid var(--border);
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
        font-weight: 500;
      }

      .option-button:hover {
        border-color: var(--accent);
        background: var(--accent);
        color: white;
        transform: translateY(-2px);
      }

      .chat-input-container {
        padding: 20px;
        background: var(--bg-tertiary);
        border-top: 1px solid var(--border);
      }

      .chat-input {
        display: flex;
        gap: 12px;
      }

      .chat-input input {
        flex: 1;
        background: var(--bg-primary);
        border: 2px solid var(--border);
        border-radius: 8px;
        padding: 12px 16px;
        font-size: 14px;
        color: var(--text-primary);
        transition: border-color 0.2s;
      }

      .chat-input input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .chat-input input::placeholder {
        color: var(--text-secondary);
      }

      .send-button {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        background: var(--accent);
        color: white;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.2s;
      }

      .send-button:hover {
        background: var(--accent-hover);
        transform: translateY(-1px);
      }

      .score-display {
        background: var(--bg-tertiary);
        padding: 16px;
        border-radius: 8px;
        border: 1px solid var(--border);
        margin-top: 12px;
        font-size: 16px;
        font-weight: 600;
        text-align: center;
      }

      .score-low {
        color: var(--success);
      }
      .score-medium {
        color: var(--warning);
      }
      .score-high {
        color: var(--danger);
      }

      .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: var(--text-secondary);
      }

      .empty-state-icon {
        font-size: 48px;
        margin-bottom: 16px;
      }

      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          align-items: flex-start;
        }

        .chat-box {
          padding: 16px;
        }

        .options-container {
          flex-direction: column;
        }

        .option-button {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-content">
          <div class="header-text">
            <h1>Mental Health Assistant</h1>
            <p>Your compassionate AI companion for mental wellness check-ins</p>
          </div>
          <a href="index.html" class="back-button">
            ‚¨ÖÔ∏è Back to Typing Tracker
          </a>
        </div>
      </header>

      <div class="chat-container">
        <div class="chat-box" id="chatBox">
          <div class="empty-state">
            <div class="empty-state-icon">üí¨</div>
            <p>Starting conversation...</p>
          </div>
        </div>

        <div class="chat-input-container">
          <div class="chat-input">
            <input
              type="text"
              id="userInput"
              placeholder="Type your message here..."
              onkeypress="if(event.key === 'Enter') sendMessage()"
            />
            <button class="send-button" onclick="sendMessage()">Send</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Global Variables for scores
      let anxietyMarks = 0,
        depressionMarks = 0,
        stressMarks = 0;
      let currentQuestion = 0,
        currentDepressionQuestion = 0,
        currentStressQuestion = 0;

      // Anxiety Questions
      const anxietyQuestions = [
        {
          question: "Do you feel nervous or on edge?",
          options: ["Not at all", "Several days", "Often", "Every day"],
        },
        {
          question: "Do you have trouble relaxing?",
          options: ["No", "Sometimes", "Often", "Always"],
        },
        {
          question: "Do you experience restlessness?",
          options: ["Never", "Rarely", "Frequently", "Always"],
        },
        {
          question: "Do you get tired easily or feel fatigued?",
          options: ["Never", "Sometimes", "Often", "Almost always"],
        },
        {
          question: "Do you have difficulty concentrating?",
          options: ["Not at all", "Occasionally", "Often", "Almost always"],
        },
        {
          question: "Do you feel easily annoyed or irritable?",
          options: ["Never", "Sometimes", "Often", "Always"],
        },
        {
          question: "Do you feel like something bad might happen?",
          options: ["Not at all", "A little", "Quite a bit", "Extremely"],
        },
        {
          question: "Do you experience sudden feelings of panic?",
          options: ["Never", "Rarely", "Sometimes", "Frequently"],
        },
        {
          question: "Do you avoid situations that make you anxious?",
          options: ["Never", "Occasionally", "Often", "All the time"],
        },
        {
          question:
            "Do you have physical symptoms like sweating, trembling, or rapid heartbeat without a clear reason?",
          options: ["Not at all", "Sometimes", "Often", "Always"],
        },
      ];

      // Depression Questions
      const depressionQuestions = [
        {
          question:
            "Over the past two weeks, how often have you felt little interest or pleasure in doing things you usually enjoy?",
          options: [
            "Not at all",
            "Several days",
            "More than half the days",
            "Nearly every day",
          ],
        },
        {
          question: "Do you have little interest or pleasure in doing things?",
          options: [
            "Not at all",
            "Several days",
            "More than half the days",
            "Nearly every day",
          ],
        },
        {
          question: "Do you feel tired or have little energy?",
          options: ["Not at all", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "Do you have trouble falling or staying asleep, or sleep too much?",
          options: [
            "No issues",
            "Some trouble",
            "Often disrupted",
            "Always disrupted",
          ],
        },
        {
          question: "Do you have poor appetite or overeating?",
          options: ["Not at all", "Sometimes", "Often", "Always"],
        },
        {
          question: "Do you feel bad about yourself or that you're a failure?",
          options: ["Never", "Occasionally", "Often", "Always"],
        },
        {
          question: "Do you have trouble concentrating on things?",
          options: ["Not at all", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "Do you move or speak so slowly that other people have noticed?",
          options: ["Not at all", "A little bit", "Often", "Almost always"],
        },
        {
          question: "Do you feel that life is not worth living?",
          options: ["Never", "Rarely", "Often", "Very often"],
        },
        {
          question: "Have you lost interest in things you once enjoyed?",
          options: ["Not at all", "Sometimes", "Often", "Always"],
        },
      ];

      // Stress Questions
      const stressQuestions = [
        {
          question:
            "In the last month, how often have you felt overwhelmed by responsibilities?",
          options: [
            "Never",
            "Almost Never",
            "Sometimes",
            "Fairly Often",
            "Very Often",
          ],
        },
        {
          question: "How often have you felt nervous or stressed?",
          options: [
            "Never",
            "Almost Never",
            "Sometimes",
            "Fairly Often",
            "Very Often",
          ],
        },
        {
          question:
            "How often have you felt you were unable to control the important things in your life?",
          options: [
            "Never",
            "Almost Never",
            "Sometimes",
            "Fairly Often",
            "Very Often",
          ],
        },
        {
          question:
            "How often have you found it difficult to relax even in calm situations?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you been easily irritated or annoyed by small things?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you felt that you were unable to cope with all the things you had to do?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you lost sleep due to stress or overthinking?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you felt pressure to meet expectations from others or yourself?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you found yourself thinking about stressful situations even when trying to relax?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
        {
          question:
            "How often have you felt emotionally drained at the end of the day?",
          options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
        },
      ];

      // Handle user selection
      function handleUserChoice(choice) {
        addUserMessage(choice);

        if (choice === "Anxiety") {
          addBotMessage(
            "I see you're feeling anxious. Let's check your anxiety level with a few quick questions."
          );
          setTimeout(() => startAnxietyTest(), 1000);
        } else if (choice === "Depression") {
          addBotMessage(
            "You might be feeling low. Let's check your depression level with a few quick questions."
          );
          setTimeout(() => startDepressionTest(), 1000);
        } else if (choice === "Stress") {
          addBotMessage(
            "You might be feeling overwhelmed. Let's check your stress level with a few quick questions."
          );
          setTimeout(() => startStressTest(), 1000);
        } else if (choice === "Just fine") {
          addBotMessage(
            "That's great to hear! üåü It looks like you're doing well mentally."
          );

          // Save default low scores so wellness page can load safely
          localStorage.setItem("anxietyScore", 0);
          localStorage.setItem("anxietyLevel", "Low");

          localStorage.setItem("depressionScore", 0);
          localStorage.setItem("depressionLevel", "Low");

          localStorage.setItem("stressScore", 0);
          localStorage.setItem("stressLevel", "Low");

          // Show completion + wellness button
          setTimeout(() => showCompleteButton(), 800);
        } else {
          // Anxiety quiz
          if (
            typeof currentQuestion !== "undefined" &&
            currentQuestion < anxietyQuestions.length
          ) {
            const selectedIndex =
              anxietyQuestions[currentQuestion].options.indexOf(choice);
            if (selectedIndex !== -1) anxietyMarks += selectedIndex + 1;
            currentQuestion++;
            setTimeout(showNextAnxietyQuestion, 500);
          }
          // Depression quiz
          else if (
            typeof currentDepressionQuestion !== "undefined" &&
            currentDepressionQuestion < depressionQuestions.length
          ) {
            const selectedIndex =
              depressionQuestions[currentDepressionQuestion].options.indexOf(
                choice
              );
            if (selectedIndex !== -1) depressionMarks += selectedIndex + 1;
            currentDepressionQuestion++;
            setTimeout(showNextDepressionQuestion, 500);
          }
          // Stress quiz
          else if (
            typeof currentStressQuestion !== "undefined" &&
            currentStressQuestion < stressQuestions.length
          ) {
            const selectedIndex =
              stressQuestions[currentStressQuestion].options.indexOf(choice);
            if (selectedIndex !== -1) stressMarks += selectedIndex + 1;
            currentStressQuestion++;
            setTimeout(showNextStressQuestion, 500);
          }
        }
      }

      function addUserMessage(text) {
        const chatbox = document.getElementById("chatBox");
        const msgDiv = document.createElement("div");
        msgDiv.className = "message user-message";
        msgDiv.innerHTML = `
        <div class="message-avatar user-avatar">üë§</div>
        <div class="message-content">
          <div class="message-text">${text}</div>
        </div>
      `;
        chatbox.appendChild(msgDiv);
        scrollToBottom();
      }

      function addBotMessage(text, options = []) {
        const chatbox = document.getElementById("chatBox");
        const msgDiv = document.createElement("div");
        msgDiv.className = "message bot-message";

        let optionsHtml = "";
        if (options.length > 0) {
          optionsHtml = '<div class="options-container">';
          options.forEach((option) => {
            optionsHtml += `<button class="option-button" onclick="handleUserChoice('${option.replace(
              /'/g,
              "\\'"
            )}')">${option}</button>`;
          });
          optionsHtml += "</div>";
        }

        msgDiv.innerHTML = `
        <div class="message-avatar bot-avatar">ü§ñ</div>
        <div class="message-content">
          <div class="message-text">${text}</div>
          ${optionsHtml}
        </div>
      `;
        chatbox.appendChild(msgDiv);
        scrollToBottom();
      }

      function scrollToBottom() {
        const chatbox = document.getElementById("chatBox");
        chatbox.scrollTop = chatbox.scrollHeight;
      }

      // ===== Anxiety Test =====
      function startAnxietyTest() {
        anxietyMarks = 0;
        currentQuestion = 0;
        showNextAnxietyQuestion();
      }

      function showNextAnxietyQuestion() {
        if (currentQuestion < anxietyQuestions.length) {
          const q = anxietyQuestions[currentQuestion];
          addBotMessage(q.question, q.options);
        } else {
          showAnxietyResult();
        }
      }

      function showAnxietyResult() {
        const percentage = (anxietyMarks / 40) * 100;
        let level, className;

        if (percentage < 40) {
          level = "Low";
          className = "score-low";
        } else if (percentage < 70) {
          level = "Moderate";
          className = "score-medium";
        } else {
          level = "High";
          className = "score-high";
        }

        // Save anxiety score to localStorage
        localStorage.setItem("anxietyScore", anxietyMarks);
        localStorage.setItem("anxietyLevel", level);

        addBotMessage(`<div class="score-display ${className}">
        ‚úÖ Your Anxiety Score: ${anxietyMarks}/40 (${percentage.toFixed(
          0
        )}%)<br>
        Level: ${level}
      </div>`);

        // Show complete button
        setTimeout(() => showCompleteButton(), 1000);
      }

      // ===== Depression Test =====
      function startDepressionTest() {
        depressionMarks = 0;
        currentDepressionQuestion = 0;
        showNextDepressionQuestion();
      }

      function showNextDepressionQuestion() {
        if (currentDepressionQuestion < depressionQuestions.length) {
          const q = depressionQuestions[currentDepressionQuestion];
          addBotMessage(q.question, q.options);
        } else {
          showDepressionResult();
        }
      }

      function showDepressionResult() {
        const percentage = (depressionMarks / 40) * 100;
        let level, className;

        if (percentage < 40) {
          level = "Low";
          className = "score-low";
        } else if (percentage < 70) {
          level = "Moderate";
          className = "score-medium";
        } else {
          level = "High";
          className = "score-high";
        }

        // Save depression score to localStorage
        localStorage.setItem("depressionScore", depressionMarks);
        localStorage.setItem("depressionLevel", level);

        addBotMessage(`<div class="score-display ${className}">
        ‚úÖ Your Depression Score: ${depressionMarks}/40 (${percentage.toFixed(
          0
        )}%)<br>
        Level: ${level}
      </div>`);

        // Show complete button
        setTimeout(() => showCompleteButton(), 1000);
      }

      // ===== Stress Test =====
      function startStressTest() {
        stressMarks = 0;
        currentStressQuestion = 0;
        showNextStressQuestion();
      }

      function showNextStressQuestion() {
        if (currentStressQuestion < stressQuestions.length) {
          const q = stressQuestions[currentStressQuestion];
          addBotMessage(q.question, q.options);
        } else {
          showStressResult();
        }
      }

      function showStressResult() {
        const percentage = (stressMarks / 50) * 100;
        let level, className;

        if (percentage < 40) {
          level = "Low";
          className = "score-low";
        } else if (percentage < 70) {
          level = "Moderate";
          className = "score-medium";
        } else {
          level = "High";
          className = "score-high";
        }

        // Save stress score to localStorage
        localStorage.setItem("stressScore", stressMarks);
        localStorage.setItem("stressLevel", level);

        addBotMessage(`<div class="score-display ${className}">
        ‚úÖ Your Stress Score: ${stressMarks}/50 (${percentage.toFixed(0)}%)<br>
        Level: ${level}
      </div>`);

        // Show complete button
        setTimeout(() => showCompleteButton(), 1000);
      }

      function showCompleteButton() {
        const chatbox = document.getElementById("chatBox");
        const msgDiv = document.createElement("div");
        msgDiv.className = "message bot-message";
        msgDiv.innerHTML = `
        <div class="message-avatar bot-avatar">ü§ñ</div>
        <div class="message-content">
          <div class="message-text">Great! You've completed the mental health assessment. Click below to view your personalized wellness recommendations.</div>
          <div class="options-container">
            <button class="option-button" style="background: linear-gradient(135deg, var(--accent), #8b5cf6); color: white; border: none; font-weight: 600;" onclick="goToWellness()">
              ‚ú® View Wellness Report
            </button>
          </div>
        </div>
      `;
        chatbox.appendChild(msgDiv);
        scrollToBottom();
      }

      function goToWellness() {
        // Ensure all data is saved before redirecting
        setTimeout(() => {
          window.location.href = "wellness.html";
        }, 100);
      }

      function sendMessage() {
        const input = document.getElementById("userInput");
        const message = input.value.trim();

        if (message) {
          addUserMessage(message);
          input.value = "";

          setTimeout(() => {
            addBotMessage(
              "Thank you for sharing. I'm here to listen. How else can I help you today?"
            );
          }, 1000);
        }
      }

      // ===== Initial Greeting =====
      window.onload = () => {
        const chatbox = document.getElementById("chatBox");
        chatbox.innerHTML = "";

        addBotMessage("Hi, I'm your mental health companion.");
        setTimeout(() => {
          addBotMessage("How are you feeling today?", [
            "Anxiety",
            "Depression",
            "Stress",
            "Just fine",
          ]);
        }, 1000);
      };
    </script>
  </body>
</html>
